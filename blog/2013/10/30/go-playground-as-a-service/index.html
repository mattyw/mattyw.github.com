
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Go playground as a service - mattyw</title>
  <meta name="author" content="Matt Williams">

  
  <meta name="description" content="One of the great things about go is the whole environment you get with it, gofmt, godoc, go get. It&rsquo;s all good stuff.
There&rsquo;s also a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mattyw.github.io/blog/2013/10/30/go-playground-as-a-service">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="mattyw" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-41678780-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">mattyw</a></h1>
  
    <h2>whatever I've been playing around with lately</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mattyw.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Go Playground as a Service</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-30T13:08:00+00:00" pubdate data-updated="true">Oct 30<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>One of the great things about go is the whole environment you get with it, gofmt, godoc, go get. It&rsquo;s all good stuff.
There&rsquo;s also a <a href="http://play.golang.org">playground</a> for you to try things out on.
The docs also have runnable examples in them based off a similar idea:
<a href="http://golang.org/pkg/encoding/json/#example_Unmarshal">http://golang.org/pkg/encoding/json/#example_Unmarshal</a></p>

<p>It&rsquo;s a great idea, it means you can actually try the code out while you&rsquo;re reading the docs. But it only works on code from the stdlib. But that makes sense doesn&rsquo;t it? You don&rsquo;t want to allow anyone to import some arbitrary package.</p>

<p>But it occured to me that when someone develops a package, the author might want to include runnable examples for their own code.</p>

<p>The source for something similar to the playgrond is incuded in the go release (misc/goplay) I&rsquo;ve modified it very slightly to allow /compile to be called from any location.
I&rsquo;ve called it <a href="http://github.com/mattyw/goplaas">goplaas</a> (It&rsquo;s not really as a service, but that&rsquo;s the standard suffix these days isn&#8217; it? And it got your attention!)</p>

<p>The idea is you install it on your own server, and it will have access to anything installed on your GOPATH. This means you can control what packages can be imported, and also the version.</p>

<p>All you need to do is put some javascript and a textarea into a webpage, point it to your server and you&rsquo;re done.</p>

<p>Here&rsquo;s an example using the loggo package from launchpad.net. Try it</p>

<script>

function insertTabs(n) {
    // find the selection start and end
    var cont  = document.getElementById("edit");
    var start = cont.selectionStart;
    var end   = cont.selectionEnd;
    // split the textarea content into two, and insert n tabs
    var v = cont.value;
    var u = v.substr(0, start);
    for (var i=0; i<n; i++) {
        u += "\t";
    }
    u += v.substr(end);
    // set revised content
    cont.value = u;
    // reset caret position after inserted tabs
    cont.selectionStart = start+n;
    cont.selectionEnd = start+n;
}

function autoindent(el) {
    var curpos = el.selectionStart;
    var tabs = 0;
    while (curpos > 0) {
        curpos--;
        if (el.value[curpos] == "\t") {
            tabs++;
        } else if (tabs > 0 || el.value[curpos] == "\n") {
            break;
        }
    }
    setTimeout(function() {
        insertTabs(tabs);
    }, 1);
}

function preventDefault(e) {
    if (e.preventDefault) {
        e.preventDefault();
    } else {
        e.cancelBubble = true;
    }
}

function keyHandler(event) {
    var e = window.event || event;
    if (e.keyCode == 9) { // tab
        insertTabs(1);
        preventDefault(e);
        return false;
    }
    if (e.keyCode == 13) { // enter
        if (e.shiftKey) { // +shift
            compile(e.target);
            preventDefault(e);
            return false;
        } else {
            autoindent(e.target);
        }
    }
    return true;
}

var xmlreq;

function autocompile() {
    if(!document.getElementById("autocompile").checked) {
        return;
    }
    compile();
}

function compile() {
    var prog = document.getElementById("edit").value;
    var req = new XMLHttpRequest();
    xmlreq = req;
    req.onreadystatechange = compileUpdate;
    req.open("POST", "http://162.243.74.193:3999/compile", true);
    req.setRequestHeader("Content-Type", "text/plain; charset=utf-8");
    req.send(prog); 
}

function compileUpdate() {
    var req = xmlreq;
    if(!req || req.readyState != 4) {
        return;
    }
    if(req.status == 200) {
        document.getElementById("output").innerHTML = req.responseText;
        document.getElementById("errors").innerHTML = "";
    } else {
        document.getElementById("errors").innerHTML = req.responseText;
        document.getElementById("output").innerHTML = "";
    }
}
</script>


<pre>
<textarea style="background-color:lightyellow;" rows="20" cols="100" autofocus="true" id="edit" spellcheck="false" onkeydown="keyHandler(event);" onkeyup="autocompile();">
package main

import (
    "launchpad.net/loggo"
)

var logger = loggo.GetLogger("main")

func main() {
    loggo.ConfigureLoggers("<root>=INFO")
    logger.Infof("Hey there")
}
</textarea>
<div class="hints">
(Shift-Enter to compile and run.)&nbsp;&nbsp;&nbsp;&nbsp;
<input type="checkbox" id="autocompile" value="checked" /> Compile and run after each keystroke
</div>
<div id="output"></div>
<div id="errors"></div>
</pre>


<p>I&rsquo;ll try to keep my server running with goplaas for the next few weeks. If it suddenly stops working, it&rsquo;s likely that I&rsquo;ve pulled the server down. You can experiment yourself by running</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>go install github.com/mattyw/goplaas
</span><span class='line'>./goplaas -http :9999 <span class="c">#Listen on 9999</span>
</span></code></pre></td></tr></table></div></figure>


<p>goplaas includes a -compile flag for sending compilation instructions to another server, full instructions are in github.</p>

<p>A good next step would be to package this all up into a docker container to allow anyone to install it with relative ease</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Matt Williams</span></span>

      








  


<time datetime="2013-10-30T13:08:00+00:00" pubdate data-updated="true">Oct 30<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/go/'>go</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://mattyw.github.io/blog/2013/10/30/go-playground-as-a-service/" data-via="matty_jwilliams" data-counturl="http://mattyw.github.io/blog/2013/10/30/go-playground-as-a-service/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/10/17/clojure-programming-in-acme/" title="Previous Post: Clojure programming in acme">&laquo; Clojure programming in acme</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Links</h1>
  <p><a href="http://mattyjwilliams.blogspot.com">Old Blog</a></p>
  <p><a href="http://www.stackoverflow.com/users/137839/mattyw">StackOverFlow</a></p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/10/30/go-playground-as-a-service/">Go Playground as a Service</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/17/clojure-programming-in-acme/">Clojure Programming in Acme</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/08/16/why-juju-means-i-dont-need-a-vps/">Why Juju Means I Don't Need a VPS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/08/13/simple-macros-in-clojure-and-elixir/">Simple Macros in Clojure and Elixir</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/27/taming-the-cloud-with-juju-and-raspberry-pi/">Taming the Cloud With Juju and Raspberry Pi</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/acme' style='font-size: 112.0%'>acme(1)</a> <a href='/blog/categories/clojure' style='font-size: 124.0%'>clojure(2)</a> <a href='/blog/categories/elixir' style='font-size: 124.0%'>elixir(2)</a> <a href='/blog/categories/go' style='font-size: 160.0%'>go(5)</a> <a href='/blog/categories/juju' style='font-size: 124.0%'>juju(2)</a> <a href='/blog/categories/mongo' style='font-size: 112.0%'>mongo(1)</a> <a href='/blog/categories/raspberrypi' style='font-size: 112.0%'>raspberrypi(1)</a> <a href='/blog/categories/ubuntu' style='font-size: 112.0%'>ubuntu(1)</a> </span>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/mattyw">@mattyw</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mattyw',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/107203120641670420594?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Matt Williams -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mattyw';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mattyw.github.io/blog/2013/10/30/go-playground-as-a-service/';
        var disqus_url = 'http://mattyw.github.io/blog/2013/10/30/go-playground-as-a-service/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
